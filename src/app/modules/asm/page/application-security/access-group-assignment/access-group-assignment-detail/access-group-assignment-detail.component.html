<div class="card">
  <div>
    <h2 class="font">Create Access Group Assignment</h2>
  </div>
</div>
<form [formGroup]="accessgroupAssignmentForm">
  <div class="p-grid p-fluid">
    <div class="p-col-12 p-md-6">
      <span class="p-float-label">
        <p-dropdown
          [options]="application"
          formControlName="applicationId"
          placeholder="Select Application"
          [ngClass]="{
            'ng-invalid ng-dirty':
              submitted &&
              accessgroupAssignmentForm.controls.applicationId.errors?.required
          }"
          optionLabel="applicationName"
          optionValue="applicationId"
          [showClear]="true"
          (onChange)="GetAccessGroup()"
        >
        </p-dropdown>
        <!-- formControlName="applicationId" -->
        <!-- <input id="float-input" type="text" pInputText [(ngModel)]="accessGroup.name" />
      <label for="float-input" class="p-component"> Name </label> -->
      </span>
      <small
        class="p-invalid error"
        *ngIf="
          submitted &&
          accessgroupAssignmentForm.controls.applicationId.errors?.required
        "
      >
        Application is required.
      </small>
    </div>

    <div class="p-col-12 p-md-6">
      <div class="p-field-radiobutton">
        <div class="p-field-radiobutton">
          <p-radioButton
            name="assignmentType"
            value="role"
            class="font"
            (onClick)="ShowRole()"
            formControlName="assignmentType"
            inputId="role"
          ></p-radioButton>
          <label for="role" class="font">Role</label>
        </div>
        <div class="p-field-radiobutton p-ml-3">
          <p-radioButton
            name="assignmentType"
            value="position"
            class="font"
            (onClick)="ShowPosition()"
            formControlName="assignmentType"
            inputId="position"
          ></p-radioButton>
          <label for="position" class="font">Position</label>
        </div>

        <!-- <div class="p-field-radiobutton p-ml-3">
        <p-radioButton
          name="assignmentType"
          value="person"
          (onClick)="ShowPerson()"
          formControlName="assignmentType"
          inputId="person"
        ></p-radioButton>
        <label for="person">Person</label>
      </div> -->

        <!-- formControlName="assignmentType" -->
      </div>
      <small
        class="p-invalid error"
        *ngIf="
          submitted &&
          accessgroupAssignmentForm.controls.assignmentType.errors?.required
        "
      >
        Role Or Position is required.
      </small>
    </div>
  </div>
  <div class="p-grid p-fluid">
    <div class="p-col-12 p-md-6 p-mb-2">
      <span class="p-float-label">
        <p-dropdown
          [options]="department"
          formControlName="departmentId"
          placeholder="Select Department"
          optionLabel="departmentName"
          optionValue="departmentId"
          [showClear]="true"
          (onChange)="GetRole(); GetAccessGroup()"
        >
        </p-dropdown>
        <!-- formControlName="departmentId" -->
      </span>
    </div>
    <div class="p-col-12 p-md-6 p-mb-2">
      <span *ngIf="showRole" class="p-float-label">
        <p-multiSelect
          [options]="role"
          formControlName="roleId"
          defaultLabel="Select Role"
          optionLabel="roleName"
          optionValue="roleId"
          [ngClass]="{
            'ng-invalid ng-dirty':
              submitted &&
              accessgroupAssignmentForm.controls.roleId.errors?.required
          }"
        >
        </p-multiSelect>
        <small
          class="p-invalid error"
          *ngIf="
            submitted &&
            accessgroupAssignmentForm.controls.roleId.errors?.required
          "
        >
          Role is required.
        </small>
      </span>

      <!-- formControlName="departmentId" -->
      <span *ngIf="showPosition" class="p-float-label">
        <p-dropdown
          [options]="role"
          [filter]="true"
          filterBy="roleName"
          formControlName="roleId"
          [ngClass]="{
            'ng-invalid ng-dirty':
              submitted &&
              accessgroupAssignmentForm.controls.roleId.errors?.required
          }"
          placeholder="Select Role"
          optionLabel="roleName"
          optionValue="roleId"
          [showClear]="true"
          (onChange)="GetPosition()"
        >
        </p-dropdown>
        <small
          class="p-invalid error"
          *ngIf="
            submitted &&
            accessgroupAssignmentForm.controls.roleId.errors?.required
          "
        >
          Role is required.
        </small>
      </span>

      <!-- <span *ngIf="showPerson" class="p-input-icon-left">
      <i class="pi pi-search"></i>
      <input
        pInputText
        type="text"
        class="search"
        placeholder="search person from MIS"
      />
    </span> -->
      <!-- (input)="dt.filterGlobal($event.target.value, 'contains')"-->
    </div>
  </div>
  <div class="p-grid p-fluid">
    <div class="p-col-12 p-md-6">
      <span class="p-float-label">
        <p-dropdown
          [options]="accessGroupList"
          formControlName="accessGroupId"
          optionValue="accessGroupId"
          [ngClass]="{
            'ng-invalid ng-dirty':
              submitted &&
              accessgroupAssignmentForm.controls.accessGroupId.errors?.required
          }"
          placeholder="Select Access Group"
          optionLabel="name"
          [showClear]="true"
          (onChange)="getAllModule()"
        >
        </p-dropdown>
      </span>
      <small
        class="p-invalid error"
        *ngIf="
          submitted &&
          accessgroupAssignmentForm.controls.accessGroupId.errors?.required
        "
      >
        Access Group is required.
      </small>
    </div>
    <div class="p-col-12 p-md-6">
      <span *ngIf="showPosition" class="p-float-label">
        <p-multiSelect
          [options]="position"
          [filter]="true"
          filterBy="positionName"
          formControlName="positionId"
          [ngClass]="{
            'ng-invalid ng-dirty':
              submitted &&
              accessgroupAssignmentForm.controls.positionId.errors?.required
          }"
          placeholder="Select Position"
          optionLabel="positionName"
          optionValue="positionId"
          [showClear]="true"
        >
        </p-multiSelect>
        <small
          class="p-invalid error"
          *ngIf="
            submitted &&
            accessgroupAssignmentForm.controls.positionId.errors?.required
          "
        >
          Position is required.
        </small>
      </span>
    </div>
  </div>
</form>
<p-table
  #dt
  [value]="accessGroups"
  [globalFilterFields]="['name']"
  [rowHover]="true"
>
  <ng-template pTemplate="header">
    <tr>
      <th pSortableColumn="application">
        Module Type <p-sortIcon field="application"></p-sortIcon>
      </th>
      <th pSortableColumn="department">
        Parent Module <p-sortIcon field="department"></p-sortIcon>
      </th>
      <th pSortableColumn="name">
        Module <p-sortIcon field="name"></p-sortIcon>
      </th>
      <th pSortableColumn="role">View</th>
      <th pSortableColumn="position">Create</th>
      <th pSortableColumn="person">Edit</th>
      <th pSortableColumn="lastUpdate">Delete</th>
      <th pSortableColumn="lastUpdate">Access</th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-accessGroup let-index>
    <tr>
      <td>{{ accessGroup.moduleType.name }}</td>
      <td *ngIf="accessGroup.parentModule !== null; else elseBlock">
        {{ accessGroup.parentModule.name }}
      </td>
      <ng-template #elseBlock>
        <td></td>
      </ng-template>
      <td>{{ accessGroup.name }}</td>
      <td
        *ngIf="
          accessGroup.accessGroupModulePermissions.hasViewAccess;
          else elseBlock
        "
      >
        Yes
      </td>
      <ng-template #elseBlock>
        <td></td>
      </ng-template>
      <td
        *ngIf="
          accessGroup.accessGroupModulePermissions.hasCreateAccess;
          else elseBlock
        "
      >
        Yes
      </td>
      <ng-template #elseBlock>
        <td></td>
      </ng-template>
      <td
        *ngIf="
          accessGroup.accessGroupModulePermissions.hasUpdateAccess;
          else elseBlock
        "
      >
        Yes
      </td>
      <ng-template #elseBlock>
        <td></td>
      </ng-template>
      <td
        *ngIf="
          accessGroup.accessGroupModulePermissions.hasDeleteAccess;
          else elseBlock
        "
      >
        Yes
      </td>
      <ng-template #elseBlock>
        <td></td>
      </ng-template>

      <td
        *ngIf="
          accessGroup.accessGroupModulePermissions.hasAccessRight;
          else elseBlock
        "
      >
        Yes
      </td>
      <ng-template #elseBlock>
        <td></td>
      </ng-template>
      <!-- <td>
        <div class="p-field-checkbox">
          <p-checkbox
            [(ngModel)]="
              accessGroup.accessGroupModulePermissions.hasCreateAccess
            "
            binary="true"
          ></p-checkbox>
        </div>
      </td>
      <td>
        <div class="p-field-checkbox">
          <p-checkbox
            [(ngModel)]="
              accessGroup.accessGroupModulePermissions.hasUpdateAccess
            "
            binary="Create"
          ></p-checkbox>
        </div>
      </td>
      <td>
        <div class="p-field-checkbox">
          <p-checkbox
            [(ngModel)]="
              accessGroup.accessGroupModulePermissions.hasDeleteAccess
            "
            binary="Delete"
          ></p-checkbox>
        </div>
      </td>
      <td></td> -->
    </tr>
  </ng-template>

  <ng-template pTemplate="summary">
    <div class="button-div">
      <button
        pButton
        type="button"
        (click)="onFormSubmit()"
        label="Save"
        class="p-button-Primary"
      ></button>
      <button
        pButton
        type="button"
        (click)="onCancelClick()"
        label="Cancel"
        class="p-button-danger p-ml-3"
      ></button>
    </div>
  </ng-template>
</p-table>