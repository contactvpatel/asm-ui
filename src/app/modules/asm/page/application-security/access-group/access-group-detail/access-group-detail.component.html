<div class="card">
  <div *ngIf="config.mode.isEdit === false; else titelElse">
    <h2 class="font">Create Access Group</h2>
  </div>
  <ng-template #titelElse>
    <h2 class="font">Edit Access Group</h2>
  </ng-template>
  <form [formGroup]="accessgroupForm">
    <div class="p-grid p-fluid">
      <div class="p-col-12 p-md-6 p-mt-2">
        <span class="p-float-label">
          <p-dropdown
            [options]="application"
            optionLabel="applicationName"
            optionValue="applicationId"
            inputId="application"
            [autoDisplayFirst]="false"
            formControlName="applicationId"
            (onChange)="getAllModule()"
            [showClear]="true"
            [ngClass]="{
              'ng-invalid ng-dirty':
                submitted &&
                accessgroupForm.controls.applicationId.errors?.required
            }"
          >
          </p-dropdown>
          <label for="application" class="p-component"
            >Select Application <RequiredFiled></RequiredFiled>
          </label>
        </span>
        <small
          class="p-invalid error"
          *ngIf="
            submitted && accessgroupForm.controls.applicationId.errors?.required
          "
        >
          Application is required.
        </small>
      </div>
      <div class="p-col-12 p-md-6 p-mt-2">
        <span class="p-float-label">
          <input
            id="name"
            type="text"
            pInputText
            formControlName="name"
            [ngClass]="{
              'ng-invalid ng-dirty':
                submitted && accessgroupForm.controls.name.errors?.required
            }"
          />
          <label for="name" class="p-component">
            Name <RequiredFiled></RequiredFiled>
          </label>
        </span>
        <small
          class="p-invalid error"
          *ngIf="submitted && accessgroupForm.controls.name.errors?.required"
        >
          Name is required.
        </small>
      </div>
    </div>
    <div class="p-grid p-fluid">
      <div class="p-col-12 p-md-6 p-mt-3">
        <span class="p-float-label">
          <p-dropdown
            inputId="department"
            [options]="department"
            optionLabel="departmentName"
            optionValue="departmentId"
            [autoDisplayFirst]="false"
            [showClear]="true"
            formControlName="departmentId"
          >
          </p-dropdown>
          <label for="department" class="p-component">Select Department </label>
        </span>
      </div>
      <div class="p-col-12 p-md-6 p-mt-3">
        <span class="p-float-label">
          <input
            id="description"
            type="text"
            pInputText
            formControlName="description"
          />
          <label for="description" class="p-component"> Description </label>
        </span>
      </div>
    </div>
    <div class="p-grid p-fluid">
      <div class="p-col-12 p-md-12 p-mt-3">
        <div class="p-field">
          <label for="moduleType" class="font">Active</label>
          <div class="p-field-radiobutton">
            <div class="p-field-radiobutton">
              <p-radioButton
                name="isActive"
                value="true"
                class="font"
                formControlName="isActive"
                inputId="op1"
              ></p-radioButton>
              <label class="font" for="true">Yes</label>
            </div>
            <div class="p-field-radiobutton p-ml-3">
              <p-radioButton
                name="isActive"
                value="false"
                class="font"
                formControlName="isActive"
                inputId="op2"
              ></p-radioButton>
              <label for="false" class="font">No</label>
            </div>
          </div>
        </div>
      </div>
    </div>
  </form>
  <p-table
    #dt
    [value]="accessGroups"
    [rowHover]="true"
    [resizableColumns]="true"
  >
    <ng-template pTemplate="colgroup">
      <colgroup>
        <col style="width: 15%" />
        <col style="width: 20%" />
        <col style="width: 25%" />
        <col style="width: 7%" />
        <col style="width: 7%" />
        <col style="width: 7%" />
        <col style="width: 7%" />
        <col style="width: 12%" />
      </colgroup>
    </ng-template>
    <ng-template pTemplate="header">
      <tr >
        <th style="text-align: center" pSortableColumn="moduleType.name">
          Module Type <p-sortIcon field="moduleType.name"></p-sortIcon>
        </th>
        <th style="text-align: center" pSortableColumn="parentModule.name">
          Parent Module <p-sortIcon field="parentModule.name"></p-sortIcon>
        </th>
        <th style="text-align: center" pSortableColumn="name">
          Module <p-sortIcon field="name"></p-sortIcon>
        </th>
        <th style="text-align: center">
          View<br />
          <p-checkbox
            [(ngModel)]="config.header.checkBox.hasViewAccess"
            ngClass="p-mt-2"
            [hidden]="!config.mode.moduleExists"
            (onChange)="selectParentCheckBox('hasViewAccess', $event)"
          ></p-checkbox>
        </th>
        <th style="text-align: center">
          Create <br />
          <p-checkbox
            [(ngModel)]="config.header.checkBox.hasCreateAccess"
            ngClass="p-mt-2"
            [hidden]="!config.mode.moduleExists"
            (onChange)="selectParentCheckBox('hasCreateAccess', $event)"
          ></p-checkbox>
        </th>
        <th style="text-align: center">
          Edit<br />
          <p-checkbox
            [(ngModel)]="config.header.checkBox.hasUpdateAccess"
            ngClass="p-mt-2"
            [hidden]="!config.mode.moduleExists"
            (onChange)="selectParentCheckBox('hasUpdateAccess', $event)"
          ></p-checkbox>
        </th>
        <th style="text-align: center">
          Delete<br />
          <p-checkbox
            [(ngModel)]="config.header.checkBox.hasDeleteAccess"
            ngClass="p-mt-2"
            [hidden]="!config.mode.moduleExists"
            (onChange)="selectParentCheckBox('hasDeleteAccess', $event)"
          ></p-checkbox>
        </th>
        <th style="text-align: center">
          Access<br />
          <div class="p-field-radiobutton p-mb-0">
            <div class="p-field-radiobutton p-mb-0">
              <p-radioButton
                ngClass="p-mt-2"
                name="isActive"
                value="true"
                [hidden]="!config.mode.moduleExists"
                [(ngModel)]="config.header.radio.active"
                (onFocus)="selectParentCheckBox('hasAccessRight')"
              ></p-radioButton>
              <label
                class="p-mt-2"
                [hidden]="!config.mode.moduleExists"
                for="true"
                >Yes</label
              >
            </div>
            <div class="p-field-radiobutton p-ml-3 p-mb-0">
              <p-radioButton
                ngClass="p-mt-2"
                name="isActive"
                value="false"
                (onFocus)="selectParentCheckBox('hasAccessRight')"
                [hidden]="!config.mode.moduleExists"
                [(ngModel)]="config.header.radio.active"
              ></p-radioButton>
              <label
                class="p-mt-2"
                [hidden]="!config.mode.moduleExists"
                for="false"
                >No</label
              >
            </div>
          </div>
        </th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-accessGroup let-index>
      <tr>
        <td style="text-align: center">{{ accessGroup.moduleType.name }}</td>
        <td style="text-align: center">
          {{ accessGroup?.parentModule?.name }}
        </td>
        <td style="text-align: center">{{ accessGroup.name }}</td>
        <td style="text-align: center">
          <p-checkbox
            [hidden]="!accessGroup.showCheckbox"
            [(ngModel)]="accessGroup.accessGroupModulePermissions.hasViewAccess"
            binary="true"
          >
          </p-checkbox>
        </td>
        <td style="text-align: center">
          <p-checkbox
            [hidden]="!accessGroup.showCheckbox"
            [(ngModel)]="
              accessGroup.accessGroupModulePermissions.hasCreateAccess
            "
            binary="true"
          >
          </p-checkbox>
        </td>
        <td style="text-align: center">
          <p-checkbox
            [hidden]="!accessGroup.showCheckbox"
            [(ngModel)]="
              accessGroup.accessGroupModulePermissions.hasUpdateAccess
            "
            binary="true"
          >
          </p-checkbox>
        </td>
        <td style="text-align: center">
          <p-checkbox
            [hidden]="!accessGroup.showCheckbox"
            [(ngModel)]="
              accessGroup.accessGroupModulePermissions.hasDeleteAccess
            "
            binary="true"
          >
          </p-checkbox>
        </td>
        <td style="text-align: center">
          <div class="p-field-radiobutton" style="margin-bottom: 0">
            <div class="p-field-radiobutton" style="margin-bottom: 0">
              <p-radioButton
                [hidden]="accessGroup.showCheckbox"
                name="isActive"
                [value]="true"
                [(ngModel)]="
                  accessGroup.accessGroupModulePermissions.hasAccessRight
                "
                inputId="true"
              ></p-radioButton>
              <label for="true" [hidden]="accessGroup.showCheckbox">Yes</label>
            </div>
            <div class="p-field-radiobutton p-ml-3" style="margin-bottom: 0">
              <p-radioButton
                [hidden]="accessGroup.showCheckbox"
                name="isActive"
                [value]="false"
                [(ngModel)]="
                  accessGroup.accessGroupModulePermissions.hasAccessRight
                "
                inputId="false"
              ></p-radioButton>
              <label for="false" [hidden]="accessGroup.showCheckbox">No</label>
            </div>
          </div>
        </td>
      </tr>
    </ng-template>
  </p-table>
  <div class="p-col-12" style="text-align: right; margin-top: 20px">
    <button
      pButton
      type="button"
      (click)="onFormSubmit()"
      label="Save"
      class="p-button-success"
    ></button>
    <button
      pButton
      type="button"
      (click)="onCancelClick()"
      label="Cancel"
      class="p-button-danger p-ml-3"
    ></button>
  </div>
</div>
